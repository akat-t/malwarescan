{% extends admin_base_template %}

{# in template #}
{% macro render_evals(model, column) %}
    <table class="table table-striped table-bordered table-hover">
    <thead>
    <tr>
        <th style="text-align: center;">Evaluation UUID</th>
        <th style="text-align: center;">Submit Date</th>
        <th style="text-align: center;">Elapsed Time</th>
        <th style="text-align: center;">Is Malicious?</th>
        <th style="text-align: center;"># of Files</th>
    </tr>
    </thead>
    <tbody>
    {% for item in model.evals|sort(attribute='date_f', reverse=True) %}
        <tr>
            <td style="text-align: center;"><a href="{{ url_for('evals.details_view', id=item.id) }}"><strong>{{ item.uuid_f }}</strong></a></td>
            <td style="text-align: center;"><strong>{{ item.date_f }}</strong></td>
            <td style="text-align: center;"><strong>{{ item.date_f|elapsedTime(item.date_b) }}</strong></td>
            <td style="text-align: center;">
            {%- if item.score > 5 %}
                <span class="label label-danger"><strong>True</strong></span>
            {% else %}
                <span class="label label-success"><strong>False</strong></span>
            {% endif -%}
            </td>
            <td style="text-align: center;"><span class="label label-primary">{{ item.files|length }}</span></td>
        </tr>
    {% endfor %}
    </tbody>
    </table>
{% endmacro %}
{% macro render_evals_cname(model, column) %}
    <table class="table table-striped table-bordered table-hover">
    <thead>
    <tr>
        <th style="text-align: center;">[X.509] Common Name</th>
        <th style="text-align: center;">Evaluation UUID</th>
        <th style="text-align: center;">Submit Date</th>
        <th style="text-align: center;">Elapsed Time</th>
        <th style="text-align: center;">Is Malicious?</th>
        <th style="text-align: center;"># of Files</th>
    </tr>
    </thead>
    <tbody>
    {% for item in model.evals|sort(attribute='date_f', reverse=True) %}
        <tr>
            <td style="text-align: center;"><a href="{{ url_for('clients.details_view', id=item.client.id) }}"><strong>{{ item.client }}</strong></td>
            <td style="text-align: center;"><a href="{{ url_for('evals.details_view', id=item.id) }}"><strong>{{ item.uuid_f }}</strong></a></td>
            <td style="text-align: center;"><strong>{{ item.date_f }}</strong></td>
            <td style="text-align: center;"><strong>{{ item.date_f|elapsedTime(item.date_b) }}</strong></td>
            <td style="text-align: center;">
            {%- if item.score > 5 %}
                <span class="label label-danger"><strong>True</strong></span>
            {% else %}
                <span class="label label-success"><strong>False</strong></span>
            {% endif -%}
            </td>
            <td style="text-align: center;"><span class="label label-primary">{{ item.files|length }}</span></td>
        </tr>
    {% endfor %}
    </tbody>
    </table>
{% endmacro %}
{% macro render_files_name(model, column) %}
    <table class="table table-striped table-bordered table-hover">
    <thead>
    <tr>
        <th style="text-align: center;">Filename</th>
        <th style="text-align: center;">Submit Date</th>
        <th style="text-align: center;">Elapsed Time</th>
        <th style="text-align: center;">Is Malicious?</th>
        <th style="text-align: center;">Message</th>
        <th style="text-align: center;"># of Evals</th>
    </tr>
    </thead>
    <tbody>
    {% for item in model.files|sort(attribute='date_b', reverse=True) %}
        <tr>
            <td style="text-align: center;"><a href="{{ url_for('files.details_view', id=item.id) }}"><strong>{{ item.name }}</strong></a></td>
            <td style="text-align: center;">{{ item.date_b }}</td>
            <td style="text-align: center;"><b><i>{{ item.exec_time|elapsedTimeSecs }}</i></b></td>
            <td style="text-align: center;">
            {%- if item.score > 5 %}
                <span class="label label-danger"><strong>True</strong></span>
            {% else %}
                <span class="label label-success"><strong>False</strong></span>
            {% endif -%}
            </td>
            <td style="text-align: center;"><strong>{{ item.status_f }}</strong></td>
            <td style="text-align: center;"><span class="label label-primary">{{ item.evals|length }}</span></td>
        </tr>
    {% endfor %}
    </tbody>
    </table>
{% endmacro %}
{% macro render_message(model, column) %}
    <strong>{{ model.message }}</strong>
{% endmacro %}
{% macro render_score(model, column) %}
    {% if model.score > 5 %}
        <span class="label label-danger"><strong>True</strong></span>
    {% else %}
        <span class="label label-success"><strong>False</strong></span>
    {% endif %}
{% endmacro %}
{% macro render_id(model, column) %}
  {% if admin_view.can_delete %}
    <form class="icon" method="POST" action="/admin/file/delete/">
        <input id="id" name="id" required="" type="hidden" value="{{ model.id }}">
        <input id="url" name="url" type="hidden" value="/admin/file/">
        {% if csrf_token %}
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        {% endif %}
        <button onclick="return safeConfirm('Are you sure you want to delete this record?');" title="Delete record">
            <span class="fa fa-trash glyphicon glyphicon-trash"></span>
        </button>
    </form>
  {% endif %}
  {% if admin_view.can_edit %}
    <a href="{{ url_for('.edit_view', id=model.id) }}">{{ model.id }}</a>
  {% else %}
    <strong>{{ model.id }}</strong>
  {% endif %}
{% endmacro %}


{% block head %}
{{ super() }}
    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='sbadmin2/css/sb-admin-2.min.css') }}">
    <!-- Custom Fonts -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='sbadmin2/css/font-awesome.min.css') }}">
{% endblock head %}
{% block tail %}
{{ super() }}
    <!-- Custom Theme JavaScript -->
    <script type="text/javascript" src="{{ url_for('static', filename='sbadmin2/js/sb-admin-2.min.js') }}"></script>
{% endblock tail %}
